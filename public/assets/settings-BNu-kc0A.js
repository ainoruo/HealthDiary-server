import"./style-6mOx-azO.js";import{s as o}from"./toast-B-6j1RQv.js";document.addEventListener("DOMContentLoaded",function(){const r=document.getElementById("settings-form");r.addEventListener("submit",async function(a){a.preventDefault();const s=localStorage.getItem("user_id");if(!s){o("User ID not found. Please log in again.");return}const d=new FormData(r),t={};if(d.forEach((e,n)=>{t[n]=e}),t.user_id=s,t["new-password"]!==t["confirm-password"]){o("New password and confirm password do not match.");return}try{const e="https://hyte24.northeurope.cloudapp.azure.com/api/users/";console.log("Request URL:",e);const n=localStorage.getItem("token");console.log("Token:",n);const c={method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`},body:JSON.stringify({username:t.username,password:t["new-password"],email:t.email,user_id:s})},u=await fetch(e,c),i=await u.json();if(!u.ok)throw new Error(i.message||"Failed to update user data");r.reset(),o("User data updated successfully!")}catch(e){console.error("Error updating user data:",e),o("Failed to update user data. Please try again.")}})});document.addEventListener("DOMContentLoaded",function(){document.getElementById("delete-user").addEventListener("click",async function(){const a=localStorage.getItem("user_id");if(document.getElementById("delete-confirm").value.toLowerCase()!=="delete user"){o('You must type "delete user" to confirm deletion.');return}if(!confirm("Are you sure you want to delete your account? This cannot be undone."))return;const d=`https://hyte24.northeurope.cloudapp.azure.com/api/users/${a}`,t=localStorage.getItem("token");try{const e=await fetch(d,{method:"DELETE",headers:{Authorization:`Bearer ${t}`}}),n=await e.json();if(e.ok)o("Account deleted successfully."),localStorage.removeItem("user_id"),localStorage.removeItem("token"),window.location.href="login.html";else throw new Error(n.message||"Failed to delete user account.")}catch{o("Failed to delete user account. Please try again.")}})});document.addEventListener("DOMContentLoaded",function(){document.querySelector(".logout a").addEventListener("click",function(a){a.preventDefault(),o("Logged out"),localStorage.removeItem("user_id"),localStorage.removeItem("token"),setTimeout(()=>{window.location.href="index.html"},2e3)})});
