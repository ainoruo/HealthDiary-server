import"./style-CNpknRdY.js";import{f as y}from"./fetch-CGUiTqyx.js";import{s}from"./toast-B-6j1RQv.js";document.addEventListener("DOMContentLoaded",function(){const o=document.querySelector(".menu-toggle"),t=document.querySelector(".menu");o.addEventListener("click",function(){t.classList.toggle("show")})});const m=document.getElementById("exercise-form");m.addEventListener("submit",I);const c=document.getElementById("edit-modal"),f=document.querySelector(".close-button"),x=document.getElementById("edit-form");f.onclick=()=>c.style.display="none";window.onclick=o=>{o.target===c&&(c.style.display="none")};async function I(o){o.preventDefault();const t=localStorage.getItem("user_id");if(!t){alert("User ID not found. Please log in again.");return}const n=new FormData(m),e={};n.forEach((r,d)=>{e[d]=r}),console.log(e),e.user_id=t;try{const r=`https://hyte24.northeurope.cloudapp.azure.com/api/entries/exercise/${t}`,a={method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify(e)};if(!(await fetch(r,a)).ok)throw new Error("Failed to add exercise");m.reset(),s("Exercise added successfully!")}catch(r){console.error("Error adding exercise:",r.message),s("Failed to add exercise. Please try again.")}}const k=document.querySelector("#fetch-data");k.addEventListener("click",l);async function l(){const t=`https://hyte24.northeurope.cloudapp.azure.com/api/entries/exercise/${localStorage.getItem("user_id")}`,e={method:"GET",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}};y(t,e).then(r=>{v(r)})}function v(o){console.log(o);const t=document.querySelector(".tbody");t.innerHTML="",o.forEach(n=>{console.log(n.date,n.type,n.duration,n.intensity);const e=document.createElement("tr"),r=new Date(n.date).toLocaleDateString("fi-FI"),d=document.createElement("td");d.innerText=r;const a=document.createElement("td");a.innerText=n.type;const u=document.createElement("td");u.innerText=n.duration;const p=document.createElement("td");p.innerText=n.intensity;const g=document.createElement("td"),i=document.createElement("button");i.className="edit",i.setAttribute("exercise-id",n.exercise_id),i.setAttribute("data-exercise-id",n.exercise_id),i.innerText="Edit",i.addEventListener("click",E=>h(E,o)),g.appendChild(i),e.appendChild(d),e.appendChild(a),e.appendChild(u),e.appendChild(p),e.appendChild(g),t.appendChild(e)}),document.querySelectorAll(".edit").forEach(n=>n.addEventListener("click",e=>h(e,o)))}function h(o,t){const n=parseInt(o.target.dataset.exerciseId,10);console.log("Entry ID:",n);const e=t.find(r=>r.exercise_id===n);document.getElementById("edit-entry-id").value=n,document.getElementById("edit-date").value=e.date,document.getElementById("edit-type").value=e.type,document.getElementById("edit-duration").value=e.duration,document.getElementById("edit-intensity").value=e.intensity,c.style.display="block"}x.addEventListener("submit",async o=>{o.preventDefault();const t=new FormData(o.target),e=`https://hyte24.northeurope.cloudapp.azure.com/api/entries/exercise/${t.get("edit-entry-id")}`,d={method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({date:t.get("edit-date"),type:t.get("edit-type"),duration:t.get("edit-duration"),intensity:t.get("edit-intensity")})};y(e,d).then(()=>{c.style.display="none",s("Nutrition entry updated!"),l()})});document.getElementById("delete-exercise").addEventListener("click",function(){document.getElementById("edit-entry-id").value&&L()});async function L(o){if(!confirm("Are you sure you want to delete this exercise?"))return;const t=`https://hyte24.northeurope.cloudapp.azure.com/api/entries/exercise/${id}`,e={method:"DELETE",headers:{Authorization:"Bearer: "+localStorage.getItem("token")}};y(t,e).then(r=>{console.log(r),s("Exercise deleted"),c.style.display="none",l()})}document.getElementById("fetch-data").addEventListener("click",l);document.addEventListener("DOMContentLoaded",function(){document.querySelector(".logout a").addEventListener("click",function(t){t.preventDefault(),s("Logging out"),localStorage.removeItem("user_id"),localStorage.removeItem("token"),setTimeout(()=>{window.location.href="index.html"},2e3)})});
