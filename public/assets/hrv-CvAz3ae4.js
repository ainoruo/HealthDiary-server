import"./style-rr3s28mv.js";import{f as y}from"./fetch-CGUiTqyx.js";import{s as c}from"./toast-B-6j1RQv.js";document.addEventListener("DOMContentLoaded",function(){const o=document.querySelector(".menu-toggle"),t=document.querySelector(".menu");o.addEventListener("click",function(){t.classList.toggle("show")})});const h=document.getElementById("exercise-form");h.addEventListener("submit",I);const s=document.getElementById("edit-modal"),f=document.querySelector(".close-button"),E=document.getElementById("edit-form");f.onclick=()=>s.style.display="none";window.onclick=o=>{o.target===s&&(s.style.display="none")};async function I(o){o.preventDefault();const t=localStorage.getItem("user_id");if(!t){c("User ID not found. Please log in again.");return}const n=new FormData(h),e={};n.forEach((d,i)=>{e[i]=d}),console.log(e);const r=new Date().toISOString();e.created_at=r,e.user_id=t;try{const d=`https://hyte24.northeurope.cloudapp.azure.com/api/entries/hrv/${t}`,l={method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify(e)};if(!(await fetch(d,l)).ok)throw new Error("Failed to add HRV Measurement");h.reset(),c("HRV measurement added successfully!")}catch(d){console.error("Error adding HRV measurement:",d.message),c("Failed to add HRM measurement. Please try again.")}}const k=document.querySelector("#fetch-data");k.addEventListener("click",u);async function u(){const t=`https://hyte24.northeurope.cloudapp.azure.com/api/entries/hrv/${localStorage.getItem("user_id")}`,e={method:"GET",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}};y(t,e).then(r=>{_(r)})}function _(o){console.log(o);const t=document.querySelector(".tbody");t.innerHTML="",o.forEach(n=>{console.log(n.measurement_date,n.time_of_day,n.hrv_value,n.notes);const e=document.createElement("tr"),r=new Date(n.measurement_date).toLocaleDateString("fi-FI"),d=document.createElement("td");d.innerText=r;const i=document.createElement("td");i.innerText=n.time_of_day;const l=document.createElement("td");l.innerText=n.hrv_value;const m=document.createElement("td");m.innerText=n.notes;const g=document.createElement("td"),a=document.createElement("button");a.className="edit",a.setAttribute("hrv-id",n.hrv_id),a.setAttribute("data-hrv-id",n.hrv_id),a.innerText="Edit",a.addEventListener("click",v=>p(v,o)),g.appendChild(a),e.appendChild(d),e.appendChild(i),e.appendChild(l),e.appendChild(m),e.appendChild(g),t.appendChild(e)}),document.querySelectorAll(".edit").forEach(n=>n.addEventListener("click",e=>p(e,o)))}function p(o,t){const n=parseInt(o.target.dataset.hrvId,10);console.log("HRV ID:",n);const e=t.find(r=>r.hrv_id===n);document.getElementById("edit-entry-id").value=n,document.getElementById("edit-date").value=e.measurement_date,document.getElementById("edit-time-of-day").value=e.time_of_day,document.getElementById("edit-hrv-value").value=e.hrv_value,document.getElementById("edit-notes").value=e.notes,s.style.display="block"}E.addEventListener("submit",async o=>{o.preventDefault();const t=new FormData(o.target),n=t.get("edit-entry-id");console.log("FormData:",t);const e=`https://hyte24.northeurope.cloudapp.azure.com/api/entries/hrv/${n}`,d={method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({measurement_date:t.get("edit-date"),time_of_day:t.get("edit-time-of-day"),hrv_value:t.get("edit-hrv-value"),notes:t.get("edit-notes")})};y(e,d).then(()=>{s.style.display="none",c("HRV measurement updated!"),u()})});document.getElementById("delete-entry").addEventListener("click",function(){const o=document.getElementById("edit-entry-id").value;o&&D(o)});async function D(o){if(!confirm("Are you sure you want to delete this Hrv Entry?"))return;const t=`https://hyte24.northeurope.cloudapp.azure.com/api/entries/hrv/${o}`,e={method:"DELETE",headers:{Authorization:"Bearer: "+localStorage.getItem("token")}};y(t,e).then(r=>{console.log(r),c("HRV measurement deleted!"),s.style.display="none",u()})}document.getElementById("fetch-data").addEventListener("click",u);document.addEventListener("DOMContentLoaded",function(){document.querySelector(".logout a").addEventListener("click",function(t){t.preventDefault(),c("Logging out"),localStorage.removeItem("user_id"),localStorage.removeItem("token"),setTimeout(()=>{window.location.href="index.html"},2e3)})});
