import"./style-928bxCnj.js";import{f as g}from"./fetch-CGUiTqyx.js";document.addEventListener("DOMContentLoaded",function(){const o=document.querySelector(".menu-toggle"),t=document.querySelector(".menu");o.addEventListener("click",function(){t.classList.toggle("show")})});const m=document.getElementById("exercise-form");m.addEventListener("submit",v);const s=document.getElementById("edit-modal"),k=document.querySelector(".close-button"),I=document.getElementById("edit-form");k.onclick=()=>s.style.display="none";window.onclick=o=>{o.target===s&&(s.style.display="none")};async function v(o){o.preventDefault();const t=localStorage.getItem("user_id");if(!t){alert("User ID not found. Please log in again.");return}const e=new FormData(m),n={};e.forEach((c,i)=>{n[i]=c}),console.log(n),n.user_id=t;try{const c=`http://localhost:3000/api/entries/exercise/${t}`,d={method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify(n)};if(!(await fetch(c,d)).ok)throw new Error("Failed to add exercise");m.reset(),alert("Exercise added successfully!")}catch(c){console.error("Error adding exercise:",c.message),alert("Failed to add exercise. Please try again.")}}const D=document.querySelector("#fetch-data");D.addEventListener("click",l);async function l(){const t=`http://localhost:3000/api/entries/exercise/${localStorage.getItem("user_id")}`,n={method:"GET",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}};g(t,n).then(c=>{L(c)})}function L(o){console.log(o);const t=document.querySelector(".tbody");t.innerHTML="",o.forEach(e=>{console.log(e.date,e.type,e.duration,e.intensity);const n=document.createElement("tr"),c=new Date(e.date).toLocaleDateString("fi-FI"),i=document.createElement("td");i.innerText=c;const d=document.createElement("td");d.innerText=e.type;const u=document.createElement("td");u.innerText=e.duration;const y=document.createElement("td");y.innerText=e.intensity;const p=document.createElement("td"),a=document.createElement("button");a.className="del",a.setAttribute("exercise_id",e.exercise_id),a.innerText="Delete",p.appendChild(a),a.addEventListener("click",f);const h=document.createElement("td"),r=document.createElement("button");r.className="edit",r.setAttribute("exercise-id",e.exercise_id),r.setAttribute("data-exercise-id",e.exercise_id),r.innerText="Edit",r.addEventListener("click",x=>E(x,o)),h.appendChild(r),n.appendChild(i),n.appendChild(d),n.appendChild(u),n.appendChild(y),n.appendChild(p),n.appendChild(h),t.appendChild(n)}),document.querySelectorAll(".del").forEach(e=>e.addEventListener("click",f)),document.querySelectorAll(".edit").forEach(e=>e.addEventListener("click",n=>E(n,o)))}function E(o,t){const e=parseInt(o.target.dataset.exerciseId,10);console.log("Entry ID:",e);const n=t.find(c=>c.exercise_id===e);document.getElementById("edit-entry-id").value=e,document.getElementById("edit-date").value=n.date,document.getElementById("edit-type").value=n.type,document.getElementById("edit-duration").value=n.duration,document.getElementById("edit-intensity").value=n.intensity,s.style.display="block"}I.addEventListener("submit",async o=>{o.preventDefault();const t=new FormData(o.target),e=t.get("edit-entry-id");console.log("FormData:",t);const n=`http://localhost:3000/api/entries/exercise/${e}`,i={method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({date:t.get("edit-date"),type:t.get("edit-type"),duration:t.get("edit-duration"),intensity:t.get("edit-intensity")})};g(n,i).then(()=>{s.style.display="none",l()})});async function f(o){console.log(o);const t=o.target.attributes.exercise_id.value;console.log(t);const e=`http://localhost:3000/api/entries/exercise/${t}`,c={method:"DELETE",headers:{Authorization:"Bearer: "+localStorage.getItem("token")}};confirm("Are you sure you want to delete exercise?")&&g(e,c).then(d=>{console.log(d),l()})}document.getElementById("fetch-data").addEventListener("click",l);document.addEventListener("DOMContentLoaded",function(){document.querySelector(".logout a").addEventListener("click",function(t){t.preventDefault(),localStorage.removeItem("user_id"),localStorage.removeItem("token"),window.location.href="login.html"})});
